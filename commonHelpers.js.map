{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form-search');\nconst btnMore = document.querySelector('.btn-more');\nconst galleryList = document.querySelector('.gallery-list');\nconst loader = document.querySelector('.loader-wrapper');\nconst API_KEY = '42027651-7bedd500762feb24dffc0a2de';\nconst url = `https://pixabay.com/api/?`;\n/* params */\nconst paramsRequest = {\n  key: API_KEY,\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 40,\n  page: 1,\n};\nlet totalPages = 0;\nconst searchParams = new URLSearchParams(paramsRequest);\n\nconst simplelightboxOptions = {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n};\nconst iziToastOptions = {\n  theme: 'dark',\n  class: 'izi-toast-error-style',\n  title: 'Error',\n  message:\n    'Sorry, there are no images matching your search query. Please try again!',\n  backgroundColor: '#EF4040',\n  iconUrl: './img/octagon.svg',\n  position: 'topRight',\n  maxWidth: '25%',\n};\nconst noMorePages = {\n  position: 'topRight',\n  message: \"We're sorry, there are no more posts to load\",\n};\nconst lightbox = new SimpleLightbox('.gallery-list a', simplelightboxOptions);\n\nform.addEventListener('submit', handleSubmit);\nbtnMore.addEventListener('click', handleGetMorePages);\n\nfunction handleGetMorePages() {\n  loader.style.display = 'flex';\n  btnMore.style.display = 'none';\n  getData();\n  scrollBehavior(loader.getBoundingClientRect().height);\n}\nfunction handleSubmit(e) {\n  e.preventDefault();\n  //reset page\n  resetPages();\n  loader.style.display = 'flex';\n  galleryList.innerHTML = '';\n  searchParams.set('q', e.target.elements.search.value);\n  getData();\n  this.reset();\n}\nfunction scrollBehavior(height) {\n  scrollBy({\n    top: height,\n    behavior: 'smooth',\n  });\n}\nfunction resetPages() {\n  totalPages = 0;\n  searchParams.set('page', 1);\n}\n// get data from server\nasync function getData() {\n  try {\n    const images = await fetchImages();\n    // Check if search return any image\n    images.totalHits > 0\n      ? renderImages(images)\n      : iziToast.error(iziToastOptions);\n    loader.style.display = 'none';\n    // In our case total number of pages is calculated on frontend\n    if (totalPages === 0) {\n      totalPages = Math.ceil(images.totalHits / searchParams.get('per_page'));\n      totalPages > 1\n        ? (btnMore.style.display = 'block')\n        : (btnMore.style.display = 'none');\n    }\n    // Check the end of the collection to display an alert\n    if (searchParams.get('page') > totalPages && totalPages !== 0) {\n      btnMore.style.display = 'none';\n      return iziToast.error(noMorePages);\n    }\n    // Increase the group number\n    let currentPage = Number(searchParams.get('page'));\n    searchParams.set('page', (currentPage += 1));\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function fetchImages() {\n  const response = await axios.get(url + searchParams);\n  return response.data;\n}\n\nconst markup = images => {\n  return images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" height=\"200\" loading=\"lazy\"/>\n        </a>\n        <div class=\"item-info\">\n        <p class=\"item-info-p\">Likes <span>${likes}</span></p>\n        <p class=\"item-info-p\">Views <span>${views}</span></p>\n        <p class=\"item-info-p\">Comments <span>${comments}</span></p>\n        <p class=\"item-info-p\">Downloads <span>${downloads}</span></p>\n        </div>\n        </li>`;\n      }\n    )\n    .join('');\n};\n\nfunction renderImages(images) {\n  galleryList.insertAdjacentHTML('beforeend', markup(images.hits));\n  lightbox.refresh();\n  scrollBehavior(galleryList.childNodes[0].getBoundingClientRect().height * 2);\n  btnMore.style.display = 'block';\n}\n"],"names":["form","btnMore","galleryList","loader","API_KEY","url","paramsRequest","totalPages","searchParams","simplelightboxOptions","iziToastOptions","noMorePages","lightbox","SimpleLightbox","handleSubmit","handleGetMorePages","getData","scrollBehavior","e","resetPages","height","images","fetchImages","renderImages","iziToast","currentPage","error","axios","markup","largeImageURL","webformatURL","tags","likes","views","comments","downloads"],"mappings":"owBAMA,MAAMA,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,WAAW,EAC5CC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAS,SAAS,cAAc,iBAAiB,EACjDC,EAAU,qCACVC,EAAM,4BAENC,EAAgB,CACpB,IAAKF,EACL,EAAG,GACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAM,CACR,EACA,IAAIG,EAAa,EACjB,MAAMC,EAAe,IAAI,gBAAgBF,CAAa,EAEhDG,EAAwB,CAC5B,aAAc,MACd,gBAAiB,SACjB,aAAc,GAChB,EACMC,EAAkB,CACtB,MAAO,OACP,MAAO,wBACP,MAAO,QACP,QACE,2EACF,gBAAiB,UACjB,QAAS,oBACT,SAAU,WACV,SAAU,KACZ,EACMC,EAAc,CAClB,SAAU,WACV,QAAS,8CACX,EACMC,EAAW,IAAIC,EAAe,kBAAmBJ,CAAqB,EAE5ET,EAAK,iBAAiB,SAAUc,CAAY,EAC5Cb,EAAQ,iBAAiB,QAASc,CAAkB,EAEpD,SAASA,GAAqB,CAC5BZ,EAAO,MAAM,QAAU,OACvBF,EAAQ,MAAM,QAAU,OACxBe,IACAC,EAAed,EAAO,sBAAuB,EAAC,MAAM,CACtD,CACA,SAASW,EAAaI,EAAG,CACvBA,EAAE,eAAc,EAEhBC,IACAhB,EAAO,MAAM,QAAU,OACvBD,EAAY,UAAY,GACxBM,EAAa,IAAI,IAAKU,EAAE,OAAO,SAAS,OAAO,KAAK,EACpDF,IACA,KAAK,MAAK,CACZ,CACA,SAASC,EAAeG,EAAQ,CAC9B,SAAS,CACP,IAAKA,EACL,SAAU,QACd,CAAG,CACH,CACA,SAASD,GAAa,CACpBZ,EAAa,EACbC,EAAa,IAAI,OAAQ,CAAC,CAC5B,CAEA,eAAeQ,GAAU,CACvB,GAAI,CACF,MAAMK,EAAS,MAAMC,IAcrB,GAZAD,EAAO,UAAY,EACfE,EAAaF,CAAM,EACnBG,EAAS,MAAMd,CAAe,EAClCP,EAAO,MAAM,QAAU,OAEnBI,IAAe,IACjBA,EAAa,KAAK,KAAKc,EAAO,UAAYb,EAAa,IAAI,UAAU,CAAC,EACtED,EAAa,EACRN,EAAQ,MAAM,QAAU,QACxBA,EAAQ,MAAM,QAAU,QAG3BO,EAAa,IAAI,MAAM,EAAID,GAAcA,IAAe,EAC1D,OAAAN,EAAQ,MAAM,QAAU,OACjBuB,EAAS,MAAMb,CAAW,EAGnC,IAAIc,EAAc,OAAOjB,EAAa,IAAI,MAAM,CAAC,EACjDA,EAAa,IAAI,OAASiB,GAAe,CAAC,CAC3C,OAAQC,EAAO,CACd,QAAQ,IAAIA,CAAK,CAClB,CACH,CAEA,eAAeJ,GAAc,CAE3B,OADiB,MAAMK,EAAM,IAAItB,EAAMG,CAAY,GACnC,IAClB,CAEA,MAAMoB,EAASP,GACNA,EACJ,IACC,CAAC,CACC,cAAAQ,EACA,aAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA,wCACyBN,CAAa;AAAA,4CACTC,CAAY,UAAUC,CAAI;AAAA;AAAA;AAAA,6CAGzBC,CAAK;AAAA,6CACLC,CAAK;AAAA,gDACFC,CAAQ;AAAA,iDACPC,CAAS;AAAA;AAAA,cAIrD,EACA,KAAK,EAAE,EAGZ,SAASZ,EAAaF,EAAQ,CAC5BnB,EAAY,mBAAmB,YAAa0B,EAAOP,EAAO,IAAI,CAAC,EAC/DT,EAAS,QAAO,EAChBK,EAAef,EAAY,WAAW,CAAC,EAAE,wBAAwB,OAAS,CAAC,EAC3ED,EAAQ,MAAM,QAAU,OAC1B"}