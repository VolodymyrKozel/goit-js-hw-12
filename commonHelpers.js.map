{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form-search');\nconst btnMore = document.querySelector('.btn-more');\nconst galleryList = document.querySelector('.gallery-list');\nconst loader = document.querySelector('.loader-wrapper');\nconst API_KEY = '42027651-7bedd500762feb24dffc0a2de';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n/* params */\nconst paramsRequest = {\n  key: API_KEY,\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 40,\n  page: 1,\n};\nlet totalPages = 0;\n/* const searchParams = new URLSearchParams(paramsRequest); */\n\nconst simplelightboxOptions = {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n};\nconst iziToastOptions = {\n  theme: 'dark',\n  class: 'izi-toast-error-style',\n  title: 'Error',\n  message:\n    'Sorry, there are no images matching your search query. Please try again!',\n  backgroundColor: '#EF4040',\n  iconUrl: './img/octagon.svg',\n  position: 'topRight',\n  maxWidth: '25%',\n};\nconst noMorePages = {\n  position: 'topRight',\n  message: \"We're sorry, there are no more posts to load\",\n};\nconst lightbox = new SimpleLightbox('.gallery-list a', simplelightboxOptions);\n\nform.addEventListener('submit', handleSubmit);\nbtnMore.addEventListener('click', handleGetMorePages);\n\nfunction handleGetMorePages() {\n  loaderOffOn('flex');\n  btnMoreDisable();\n  getData();\n  scrollBehavior(loader.getBoundingClientRect().height);\n}\nfunction handleSubmit(e) {\n  e.preventDefault();\n  resetPages();\n  loaderOffOn('flex');\n  galleryList.innerHTML = '';\n  paramsRequest.q = e.target.elements.search.value;\n  e.target.elements.perPage.value !== \"\" ? paramsRequest.per_page = e.target.elements.perPage.value : paramsRequest.per_page = 40;\n  getData();\n  this.reset();\n}\nfunction scrollBehavior(height) {\n  scrollBy({\n    top: height,\n    behavior: 'smooth',\n  });\n}\nfunction resetPages() {\n  totalPages = 0;\n  paramsRequest.page =  1;\n}\nfunction getTotalPages(images) {\n  totalPages = Math.ceil(images.totalHits / paramsRequest.per_page);\n}\nfunction btnMoreDisable(){\n  totalPages > 1\n  ? (btnMore.style.display = 'block')\n  : (btnMore.style.display = 'none');\n  if (paramsRequest.page >= totalPages && totalPages !== 0) {\n    btnMore.style.display = 'none';\n    return iziToast.error(noMorePages);\n  }\n}\nfunction loaderOffOn(display) {\n  loader.style.display = display;\n}\n// get data from server\nasync function getData() {\n  try {\n    const images = await fetchImages();\n    totalPages === 0 ? getTotalPages(images) : console.log('getTotalPages not run');\n    btnMoreDisable();\n    // Check if search return any image\n    images.totalHits > 0\n      ? renderImages(images)\n      : iziToast.error(iziToastOptions);\n      loaderOffOn('none');\n    // Check the end of the collection to display an alert\n\n    // Increase the group number\n    paramsRequest.page++;\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function fetchImages() {\n  const response = await axios.get('', { params: paramsRequest });\n  return response.data;\n}\n\nconst markup = images => {\n  return images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" height=\"200\" loading=\"lazy\"/>\n        </a>\n        <div class=\"item-info\">\n        <p class=\"item-info-p\">Likes <span>${likes}</span></p>\n        <p class=\"item-info-p\">Views <span>${views}</span></p>\n        <p class=\"item-info-p\">Comments <span>${comments}</span></p>\n        <p class=\"item-info-p\">Downloads <span>${downloads}</span></p>\n        </div>\n        </li>`;\n      }\n    )\n    .join('');\n};\n\nfunction renderImages(images) {\n  galleryList.insertAdjacentHTML('beforeend', markup(images.hits));\n  lightbox.refresh();\n  scrollBehavior(galleryList.childNodes[0].getBoundingClientRect().height * 2);\n}\n"],"names":["form","btnMore","galleryList","loader","API_KEY","axios","paramsRequest","totalPages","simplelightboxOptions","iziToastOptions","noMorePages","lightbox","SimpleLightbox","handleSubmit","handleGetMorePages","loaderOffOn","btnMoreDisable","getData","scrollBehavior","resetPages","height","getTotalPages","images","iziToast","display","fetchImages","renderImages","error","markup","largeImageURL","webformatURL","tags","likes","views","comments","downloads"],"mappings":"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"}